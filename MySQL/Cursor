CREATE TABLE Student (roll_no INT PRIMARY KEY, name VARCHAR(100));

INSERT INTO Student VALUES (101, 'Aarav'), (102, 'Diya'), (103, 'Kabir'),
(104, 'Meera');

CREATE TABLE CopyStudent (roll_no INT PRIMARY KEY, name VARCHAR(100));

INSERT INTO CopyStudent VALUES (102, 'Diya'),(104, 'Meera');

DELIMITER //

CREATE PROCEDURE CopyDetails()
BEGIN
  DECLARE v_roll INT;
  DECLARE v_name VARCHAR(100);
  DECLARE end_of_data INT DEFAULT FALSE;

  DECLARE cur CURSOR FOR
    SELECT roll_no, name FROM Student;

  DECLARE CONTINUE HANDLER FOR NOT FOUND SET end_of_data = TRUE;

  OPEN cur;

  FETCH cur INTO v_roll, v_name;

  WHILE NOT end_of_data DO
    IF v_roll NOT IN (SELECT roll_no FROM CopyStudent) THEN
      INSERT INTO CopyStudent VALUES (v_roll, v_name);
    END IF;

    FETCH cur INTO v_roll, v_name;
  END WHILE;

  CLOSE cur;
END //

DELIMITER ;

SELECT roll_no from CopyStudent;
SELECT * from CopyStudent;
call CopyDetails;

SELECT * from CopyStudent;
