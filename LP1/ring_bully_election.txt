'''def bully(nodes,initiator,alive):
    if initiator not in alive:
        print(f"Initiator {initiator} is not alive thus unable to start election")
        return 
       
    higher= [p for p in nodes if p>initiator and p in alive]  
    
    if not higher:
        print(f"no higher priority nodes than {initiator} ")
        print(f"initiator becomes head")
        return initiator
    
    for q in higher:
        print(f"Initiator {initiator} sends mesage to {q}")
        print(f"{q} starts own election")
        return bully(nodes,q,alive)'''

def bully(nodes, initiator, alive, visited=None):
    if visited is None:
        visited = set()

    if initiator not in alive:
        print(f"Initiator {initiator} is not alive, cannot start election")
        return None

    if initiator in visited:
        return None  # Already handled
    visited.add(initiator)

    higher = [p for p in nodes if p > initiator and p in alive]
    if not higher:
        print(f"No higher nodes than {initiator}. Node {initiator} becomes leader")
        return initiator

    candidates = []
    for q in higher:
        print(f"{initiator} sends election message to {q}")
        print(f"{q} receives message and starts its own election")
        leader = bully(nodes, q, alive, visited)
        if leader:
            candidates.append(leader)

    return max(candidates) if candidates else initiator

nodes=[1,2,3,4,5]
initiator=2
alive=[1,2,3,5]

print("LEADER IS", bully(nodes,initiator,alive))


def ring(processes, initiator, alive):
    msg = []
    i = initiator

    while True:
        if i in alive:
            msg.append(i)
        i = (i + 1) % len(processes)
        if i == initiator:
            break

    print("Message passed:", msg)
    print("Coordinator:", max(msg))
    
processes = [0, 1, 2, 3, 4]
alive = [0, 2, 3, 4]  # Process 1 is dead
initiator = 2

ring(processes, initiator, alive)
